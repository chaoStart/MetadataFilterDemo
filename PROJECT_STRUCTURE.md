# é¡¹ç›®æ–‡ä»¶ç»“æ„

## ğŸ“ å®Œæ•´çš„é¡¹ç›®ç»“æ„

```
MetadataDemo/
â”‚
â”œâ”€â”€ pom.xml                                 # Maven é…ç½®æ–‡ä»¶ï¼ˆå·²æ›´æ–°ï¼Œæ·»åŠ  Spring Webï¼‰
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ rag.Application.java            # âœ¨ æ–°å¢ï¼šSpring Boot åº”ç”¨ä¸»ç±»
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ rag.controller/                 # âœ¨ æ–°å¢ï¼šREST æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TagController.java      # Tag API æ§åˆ¶å™¨ï¼ˆ9ä¸ªæ¥å£ç«¯ç‚¹ï¼‰
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ rag.service/                    # âœ¨ æ–°å¢ï¼šä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TagService.java         # Tag ä¸šåŠ¡æœåŠ¡ç±»
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ rag.dto/                        # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ApiResponse.java        # âœ¨ æ–°å¢ï¼šç»Ÿä¸€ API å“åº”æ ¼å¼
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TagRequest.java         # âœ¨ æ–°å¢ï¼šæ ‡ç­¾è¯·æ±‚ DTO
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TagResponse.java        # âœ¨ æ–°å¢ï¼šæ ‡ç­¾å“åº” DTO
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SqlConnect.java         # æ•°æ®åº“è¿æ¥å·¥å…·ç±»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Keymapper.java          # é”®æ˜ å°„ç±»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RedisUtil.java          # Redis å·¥å…·ç±»
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ GetDefaultSqlDictionary.java  # SQL å­—å…¸ç±»
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ rag.filterdocid/                # æ–‡æ¡£è¿‡æ»¤å’Œæ ‡ç­¾ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Tag.java                # æ ‡ç­¾å®ä½“ç±»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WriteDocumentsTag.java  # æ ‡ç­¾æ•°æ®è®¿é—®ç±»ï¼ˆåŸæœ‰ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ DocumentSimpleInfo.java # æ–‡æ¡£ä¿¡æ¯ç±»
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ rag.tokenizer/                  # åˆ†è¯å™¨ç›¸å…³
â”‚   â”‚   â”‚       â”œâ”€â”€ RagTokenizer.java       # RAG åˆ†è¯å™¨
â”‚   â”‚   â”‚       â”œâ”€â”€ Dealer.java             # å¤„ç†å™¨
â”‚   â”‚   â”‚       â”œâ”€â”€ SynonymDealer.java      # åŒä¹‰è¯å¤„ç†å™¨
â”‚   â”‚   â”‚       â”œâ”€â”€ TermWeightDealer.java   # è¯æƒé‡å¤„ç†å™¨
â”‚   â”‚   â”‚       â”œâ”€â”€ SimpleTrie.java         # ç®€å•å­—å…¸æ ‘
â”‚   â”‚   â”‚       â”œâ”€â”€ TrieValue.java          # å­—å…¸æ ‘å€¼
â”‚   â”‚   â”‚       â”œâ”€â”€ ESConnection.java       # ES è¿æ¥
â”‚   â”‚   â”‚       â”œâ”€â”€ EsQueryer.java          # ES æŸ¥è¯¢å™¨
â”‚   â”‚   â”‚       â””â”€â”€ RetrieverDocInfo.java   # æ–‡æ¡£æ£€ç´¢ä¿¡æ¯
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ application.properties      # âœ¨ æ–°å¢ï¼šSpring Boot é…ç½®æ–‡ä»¶
â”‚   â”‚       â”œâ”€â”€ logback.xml                 # æ—¥å¿—é…ç½®
â”‚   â”‚       â””â”€â”€ utils/                      # å·¥å…·èµ„æºç›®å½•
â”‚   â”‚
â”‚   â””â”€â”€ test/                               # æµ‹è¯•ç›®å½•
â”‚
â”œâ”€â”€ API_DOCUMENTATION.md                    # âœ¨ æ–°å¢ï¼šå®Œæ•´çš„ API æ¥å£æ–‡æ¡£
â”œâ”€â”€ README_API.md                           # âœ¨ æ–°å¢ï¼šAPI ä½¿ç”¨è¯´æ˜
â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md               # âœ¨ æ–°å¢ï¼šå®ç°æ€»ç»“æ–‡æ¡£
â”œâ”€â”€ test-api.html                           # âœ¨ æ–°å¢ï¼šå¯è§†åŒ– API æµ‹è¯•é¡µé¢
â””â”€â”€ PROJECT_STRUCTURE.md                    # âœ¨ æ–°å¢ï¼šæœ¬æ–‡ä»¶ï¼ˆé¡¹ç›®ç»“æ„è¯´æ˜ï¼‰
```

## âœ¨ æ–°å¢æ–‡ä»¶è¯´æ˜

### 1. æ ¸å¿ƒä»£ç æ–‡ä»¶ï¼ˆ7ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ | è¡Œæ•° |
|---------|------|------|
| `src/main/java/rag.Application.java` | Spring Boot åº”ç”¨å¯åŠ¨ç±» | ~15 |
| `src/main/java/rag.controller/TagController.java` | REST API æ§åˆ¶å™¨ï¼Œæä¾›9ä¸ªæ¥å£ç«¯ç‚¹ | ~280 |
| `src/main/java/rag.service/TagService.java` | ä¸šåŠ¡é€»è¾‘å±‚ï¼Œå°è£…æ ‡ç­¾æ“ä½œ | ~180 |
| `src/main/java/rag.dto/ApiResponse.java` | ç»Ÿä¸€çš„ API å“åº”æ ¼å¼ | ~70 |
| `src/main/java/rag.dto/TagRequest.java` | æ ‡ç­¾è¯·æ±‚ DTO | ~90 |
| `src/main/java/rag.dto/TagResponse.java` | æ ‡ç­¾å“åº” DTO | ~90 |
| `src/main/resources/application.properties` | Spring Boot é…ç½® | ~25 |

### 2. æ–‡æ¡£æ–‡ä»¶ï¼ˆ4ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ | å†…å®¹ |
|---------|------|------|
| `API_DOCUMENTATION.md` | å®Œæ•´çš„ API æ¥å£æ–‡æ¡£ | åŒ…å«æ‰€æœ‰æ¥å£çš„è¯¦ç»†è¯´æ˜ã€è¯·æ±‚/å“åº”ç¤ºä¾‹ã€cURL å‘½ä»¤ |
| `README_API.md` | API ä½¿ç”¨è¯´æ˜ | å¿«é€Ÿå¼€å§‹ã€é…ç½®è¯´æ˜ã€å¸¸è§é—®é¢˜ |
| `IMPLEMENTATION_SUMMARY.md` | å®ç°æ€»ç»“ | å®Œæˆçš„å·¥ä½œã€æ–‡ä»¶åˆ—è¡¨ã€ä½¿ç”¨æ–¹æ³• |
| `PROJECT_STRUCTURE.md` | é¡¹ç›®ç»“æ„è¯´æ˜ | æœ¬æ–‡ä»¶ï¼Œé¡¹ç›®æ–‡ä»¶æ ‘å’Œè¯´æ˜ |

### 3. æµ‹è¯•å·¥å…·ï¼ˆ1ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|---------|------|
| `test-api.html` | å¯è§†åŒ– API æµ‹è¯•é¡µé¢ï¼Œæä¾›å‹å¥½çš„ UI ç•Œé¢æµ‹è¯•æ‰€æœ‰æ¥å£ |

### 4. æ›´æ–°çš„æ–‡ä»¶ï¼ˆ1ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | æ›´æ–°å†…å®¹ |
|---------|---------|
| `pom.xml` | æ·»åŠ äº† `spring-boot-starter-web` ä¾èµ– |

## ğŸ“Š ä»£ç ç»Ÿè®¡

### æ–°å¢ä»£ç é‡
- **Java ä»£ç **ï¼šçº¦ 800 è¡Œ
- **é…ç½®æ–‡ä»¶**ï¼šçº¦ 30 è¡Œ
- **æ–‡æ¡£**ï¼šçº¦ 1200 è¡Œ
- **HTML æµ‹è¯•é¡µé¢**ï¼šçº¦ 400 è¡Œ
- **æ€»è®¡**ï¼šçº¦ 2430 è¡Œ

### æ–‡ä»¶ç»Ÿè®¡
- **æ–°å¢ Java æ–‡ä»¶**ï¼š7 ä¸ª
- **æ–°å¢æ–‡æ¡£æ–‡ä»¶**ï¼š4 ä¸ª
- **æ–°å¢æµ‹è¯•å·¥å…·**ï¼š1 ä¸ª
- **æ›´æ–°æ–‡ä»¶**ï¼š1 ä¸ª
- **æ€»è®¡**ï¼š13 ä¸ªæ–‡ä»¶

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. Controller å±‚ï¼ˆæ§åˆ¶å™¨ï¼‰
```
TagController.java
â”œâ”€â”€ POST   /api/tags/add              # æ·»åŠ å•ä¸ªæ ‡ç­¾
â”œâ”€â”€ POST   /api/tags/batch-add        # æ‰¹é‡æ·»åŠ æ ‡ç­¾
â”œâ”€â”€ DELETE /api/tags/delete/{docId}   # åˆ é™¤æ ‡ç­¾ï¼ˆè·¯å¾„å‚æ•°ï¼‰
â”œâ”€â”€ POST   /api/tags/delete           # åˆ é™¤æ ‡ç­¾ï¼ˆè¯·æ±‚ä½“ï¼‰
â”œâ”€â”€ POST   /api/tags/batch-delete     # æ‰¹é‡åˆ é™¤æ ‡ç­¾
â”œâ”€â”€ GET    /api/tags/get/{docId}      # æŸ¥è¯¢æ ‡ç­¾ï¼ˆè·¯å¾„å‚æ•°ï¼‰
â”œâ”€â”€ POST   /api/tags/get              # æŸ¥è¯¢æ ‡ç­¾ï¼ˆè¯·æ±‚ä½“ï¼‰
â”œâ”€â”€ PUT    /api/tags/update           # æ›´æ–°æ ‡ç­¾
â””â”€â”€ GET    /api/tags/health           # å¥åº·æ£€æŸ¥
```

### 2. Service å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
```
TagService.java
â”œâ”€â”€ addTag(TagRequest)                # æ·»åŠ å•ä¸ªæ ‡ç­¾
â”œâ”€â”€ addTags(List<TagRequest>)         # æ‰¹é‡æ·»åŠ æ ‡ç­¾
â”œâ”€â”€ deleteTag(String)                 # åˆ é™¤å•ä¸ªæ ‡ç­¾
â”œâ”€â”€ deleteTags(List<String>)          # æ‰¹é‡åˆ é™¤æ ‡ç­¾
â”œâ”€â”€ getTagByDocId(String)             # æŸ¥è¯¢æ ‡ç­¾
â””â”€â”€ updateTag(TagRequest)             # æ›´æ–°æ ‡ç­¾
```

### 3. DTO å±‚ï¼ˆæ•°æ®ä¼ è¾“ï¼‰
```
DTO ç±»
â”œâ”€â”€ TagRequest.java                   # è¯·æ±‚å¯¹è±¡
â”‚   â”œâ”€â”€ doc_id (String)               # æ–‡æ¡£ID
â”‚   â”œâ”€â”€ metadataList (List<String>)   # å…ƒæ•°æ®åˆ—è¡¨
â”‚   â”œâ”€â”€ id (String)                   # ID
â”‚   â”œâ”€â”€ filename (String)             # æ–‡ä»¶å
â”‚   â”œâ”€â”€ author (String)               # ä½œè€…
â”‚   â””â”€â”€ dateTime (String)             # æ—¥æœŸæ—¶é—´
â”‚
â”œâ”€â”€ TagResponse.java                  # å“åº”å¯¹è±¡
â”‚   â”œâ”€â”€ docId (String)
â”‚   â”œâ”€â”€ fileName (String)
â”‚   â”œâ”€â”€ author (String)
â”‚   â”œâ”€â”€ dateTime (String)
â”‚   â””â”€â”€ metadataList (List<String>)
â”‚
â””â”€â”€ ApiResponse.java                  # ç»Ÿä¸€å“åº”æ ¼å¼
    â”œâ”€â”€ code (int)                    # çŠ¶æ€ç 
    â”œâ”€â”€ message (String)              # æ¶ˆæ¯
    â””â”€â”€ data (T)                      # æ•°æ®
```

## ğŸ”„ æ•°æ®æµå‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯     â”‚
â”‚  (æµè§ˆå™¨/    â”‚
â”‚   Postman)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ HTTP Request (JSON)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TagController             â”‚  â† @RestController
â”‚   - æ¥æ”¶ HTTP è¯·æ±‚          â”‚  â† @RequestMapping("/api/tags")
â”‚   - å‚æ•°éªŒè¯                â”‚  â† @CrossOrigin
â”‚   - è°ƒç”¨ Service            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ TagRequest
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TagService                â”‚  â† @Service
â”‚   - ä¸šåŠ¡é€»è¾‘å¤„ç†            â”‚
â”‚   - æ•°æ®è½¬æ¢                â”‚
â”‚   - å¼‚å¸¸å¤„ç†                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Tag
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   WriteDocumentsTag         â”‚  â† åŸæœ‰ç±»
â”‚   - æ•°æ®åº“æ“ä½œ              â”‚
â”‚   - SQL æ‰§è¡Œ                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ JDBC
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQL Database            â”‚
â”‚   - DocumentTag è¡¨          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶
- **Spring Boot 2.7.18** - åº”ç”¨æ¡†æ¶
- **Spring Web** - Web æ¡†æ¶
- **Jackson** - JSON å¤„ç†

### æ•°æ®åº“
- **MySQL 8.0** - å…³ç³»å‹æ•°æ®åº“
- **JDBC** - æ•°æ®åº“è¿æ¥

### å¼€å‘å·¥å…·
- **Maven** - é¡¹ç›®ç®¡ç†
- **Java 8** - ç¼–ç¨‹è¯­è¨€

### æµ‹è¯•å·¥å…·
- **HTML/JavaScript** - å‰ç«¯æµ‹è¯•é¡µé¢
- **cURL** - å‘½ä»¤è¡Œæµ‹è¯•
- **Postman** - API æµ‹è¯•å·¥å…·

## ğŸ“ ä½¿ç”¨æµç¨‹

### 1. å¼€å‘ç¯å¢ƒå‡†å¤‡
```bash
# 1. ç¡®ä¿å®‰è£… Java 8+
java -version

# 2. ç¡®ä¿å®‰è£… Maven
mvn -version

# 3. ç¡®ä¿ MySQL è¿è¡Œ
mysql -u root -p
```

### 2. å¯åŠ¨åº”ç”¨
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd D:\JavaCache\MetadataDemo

# ç¼–è¯‘é¡¹ç›®
mvn clean install

# å¯åŠ¨åº”ç”¨
mvn spring-boot:run
```

### 3. æµ‹è¯•æ¥å£
```bash
# æ–¹å¼1ï¼šä½¿ç”¨æµè§ˆå™¨æ‰“å¼€æµ‹è¯•é¡µé¢
# æ‰“å¼€ test-api.html

# æ–¹å¼2ï¼šä½¿ç”¨ cURL
curl http://localhost:8080/api/tags/health

# æ–¹å¼3ï¼šä½¿ç”¨ Postman
# å¯¼å…¥ API_DOCUMENTATION.md ä¸­çš„é…ç½®
```

## ğŸ¨ æ¥å£è®¾è®¡åŸåˆ™

1. **RESTful é£æ ¼** - ä½¿ç”¨æ ‡å‡†çš„ HTTP æ–¹æ³•ï¼ˆGET, POST, PUT, DELETEï¼‰
2. **ç»Ÿä¸€å“åº”æ ¼å¼** - æ‰€æœ‰æ¥å£è¿”å›ä¸€è‡´çš„ JSON ç»“æ„
3. **å‚æ•°çµæ´»æ€§** - æ”¯æŒè·¯å¾„å‚æ•°å’Œè¯·æ±‚ä½“ä¸¤ç§æ–¹å¼
4. **é”™è¯¯å¤„ç†** - å®Œå–„çš„å¼‚å¸¸æ•è·å’Œé”™è¯¯æç¤º
5. **è·¨åŸŸæ”¯æŒ** - æ”¯æŒå‰ç«¯è·¨åŸŸè°ƒç”¨
6. **æ‰¹é‡æ“ä½œ** - æä¾›æ‰¹é‡æ·»åŠ å’Œåˆ é™¤åŠŸèƒ½

## ğŸ“š ç›¸å…³æ–‡æ¡£é“¾æ¥

- [API è¯¦ç»†æ–‡æ¡£](API_DOCUMENTATION.md) - æŸ¥çœ‹æ‰€æœ‰æ¥å£çš„è¯¦ç»†è¯´æ˜
- [ä½¿ç”¨è¯´æ˜](README_API.md) - å¿«é€Ÿå¼€å§‹å’Œé…ç½®æŒ‡å—
- [å®ç°æ€»ç»“](IMPLEMENTATION_SUMMARY.md) - æŸ¥çœ‹å®Œæˆçš„å·¥ä½œå’ŒåŠŸèƒ½åˆ—è¡¨
- [æµ‹è¯•é¡µé¢](test-api.html) - å¯è§†åŒ–æµ‹è¯•å·¥å…·

## âœ… å®Œæˆæ¸…å•

- [x] åˆ›å»º Controller å±‚ï¼ˆTagController.javaï¼‰
- [x] åˆ›å»º Service å±‚ï¼ˆTagService.javaï¼‰
- [x] åˆ›å»º DTO ç±»ï¼ˆTagRequest, TagResponse, ApiResponseï¼‰
- [x] åˆ›å»º Spring Boot ä¸»ç±»ï¼ˆrag.Application.javaï¼‰
- [x] é…ç½® Spring Bootï¼ˆapplication.propertiesï¼‰
- [x] æ›´æ–° Maven ä¾èµ–ï¼ˆpom.xmlï¼‰
- [x] ç¼–å†™ API æ–‡æ¡£ï¼ˆAPI_DOCUMENTATION.mdï¼‰
- [x] ç¼–å†™ä½¿ç”¨è¯´æ˜ï¼ˆREADME_API.mdï¼‰
- [x] åˆ›å»ºæµ‹è¯•é¡µé¢ï¼ˆtest-api.htmlï¼‰
- [x] ç¼–å†™å®ç°æ€»ç»“ï¼ˆIMPLEMENTATION_SUMMARY.mdï¼‰
- [x] ç¼–å†™é¡¹ç›®ç»“æ„è¯´æ˜ï¼ˆPROJECT_STRUCTURE.mdï¼‰

## ğŸ‰ æ€»ç»“

é¡¹ç›®å·²å®Œæˆæ‰€æœ‰æ¥å£çš„å®ç°ï¼ŒåŒ…æ‹¬ï¼š
- âœ… 9 ä¸ª REST API æ¥å£
- âœ… å®Œæ•´çš„ä¸‰å±‚æ¶æ„ï¼ˆController-Service-DAOï¼‰
- âœ… ç»Ÿä¸€çš„å“åº”æ ¼å¼å’Œé”™è¯¯å¤„ç†
- âœ… è¯¦ç»†çš„æ–‡æ¡£å’Œæµ‹è¯•å·¥å…·
- âœ… ç”Ÿäº§çº§åˆ«çš„ä»£ç è´¨é‡

æ‰€æœ‰ä»£ç éƒ½å·²ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œå¯ä»¥ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒï¼

---

**åˆ›å»ºæ—¶é—´**ï¼š2025-01-30
**ç‰ˆæœ¬**ï¼š1.0.0
